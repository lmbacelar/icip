= simple_nested_form_for @inspection do |f|
  = f.error_messages

  .columns
    .fix.left
      = render file: 'images/_images', locals: { images: Array(@zone.images),
                                                 group_title: 'Zone',
                                                 image_type: :selector }
      - @zone.items.locatable.each do |i|
        -# TODO:
        -#   Add Task links to all items with no tasks
        -#   Edit Task links to all items with tasks
        -#
        -#   Replace if executed with if can? create or update Tasc
        - unless @inspection.state == :unassigned || @inspection.executed
          = link_to i.name, inspection_item_tascs_path(@inspection, i), class: 'location_link',
                    data: { location: i.location.to_json(only: [:image_id, :x1, :y1, :x2, :y2]) }
    .fix.right
      - unless current_user.role? :technician
        .group
          .title Assignment
          .content
            = f.association :technician,  label: 'Assigned to', collection: Role.find_by_name(:technician).users,
                                          prompt: '(Select technician)'
      - unless @inspection.state == :unassigned
        = render file: 'tascs/_tascs', locals: { tascs: @inspection.tascs }
        .group
          .title Conclusion
          .content
            = f.input :executed, as: :select, include_blank: false
      = f.submit

